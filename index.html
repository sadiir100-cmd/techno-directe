<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Techno Direct - Boutique</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f8f8f8;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin: 20px auto;
      padding: 15px;
      width: 90%;
      max-width: 400px;
    }
    .card img {
      width: 100%;
      border-radius: 8px;
    }
    .info {
      margin-top: 10px;
    }
    .price {
      color: #007bff;
      font-weight: bold;
    }
    .btn {
      display: inline-block;
      background: #007bff;
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      text-decoration: none;
      margin-right: 5px;
      margin-top: 5px;
      cursor: pointer;
    }
    .btn:hover {
      background: #0056b3;
    }
    .admin-zone {
      background: #222;
      color: #fff;
      padding: 15px;
      margin: 20px;
      border-radius: 10px;
      display: none;
    }
    .admin-zone button {
      margin-top: 10px;
    }
  </style>
</head>
<body>

<!-- Produit 2 -->
<div class="card" data-produit="Lenovo ThinkPad T480" data-prix="72000">
  <img src="https://images.unsplash.com/photo-1541807084-5c52b6b3adef?auto=format&fit=crop&w=800&q=60" alt="ThinkPad">
  <div class="info">
    <h2>Lenovo ThinkPad T480</h2>
    <p>Intel Core i7-8650U â€¢ 16 Go DDR4 â€¢ SSD 512 Go â€¢ 14â€³ Full HD</p>
    <p class="price prix-produit" data-prix="72000">72 000 DA</p>
    <label class="label-wilaya">Wilaya de livraison :
      <select class="wilaya" required></select>
    </label>
    <p class="total"><strong>Total : <span class="montant">72 000 DA</span></strong></p>
    <a class="btn whatsapp" href="#">Commander sur WhatsApp</a>
    <button class="btn formulaire">Remplir le formulaire</button>
  </div>
</div>

<!-- Produit 3 -->
<div class="card" data-produit="MacBook Air 2018" data-prix="94000">
  <img src="https://images.unsplash.com/photo-1629131726692-1accd0c53ce0?auto=format&fit=crop&w=800&q=60" alt="MacBook">
  <div class="info">
    <h2>MacBook Air 2018</h2>
    <p>Intel Core i5 â€¢ 8 Go â€¢ SSD 256 Go â€¢ 13,3â€³ Retina</p>
    <p class="price prix-produit" data-prix="94000">94 000 DA</p>
    <label class="label-wilaya">Wilaya de livraison :
      <select class="wilaya" required></select>
    </label>
    <p class="total"><strong>Total : <span class="montant">94 000 DA</span></strong></p>
    <a class="btn whatsapp" href="#">Commander sur WhatsApp</a>
    <button class="btn formulaire">Remplir le formulaire</button>
  </div>
</div>

<!-- ADMIN ZONE -->
<div class="admin-zone" id="adminZone">
  <h3>Zone Admin â€“ Commandes formulaire</h3>
  <pre id="adminPre"></pre>
</div>

<script>
/* === DÃ©clencheur admin cachÃ© === */
const adminTrigger = document.createElement('div');
adminTrigger.style.position = 'fixed';
adminTrigger.style.top = '0';
adminTrigger.style.left = '0';
adminTrigger.style.width = '100px';
adminTrigger.style.height = '100px';
adminTrigger.style.zIndex = '9999';
adminTrigger.style.background = 'transparent';
adminTrigger.style.cursor = 'pointer';
document.body.appendChild(adminTrigger);

/* === Zone admin masquÃ©e au dÃ©part === */
const adminZone = document.getElementById("adminZone");
adminZone.style.display = "none";

adminTrigger.addEventListener("dblclick", () => {
  const mdp = prompt("Entre le mot de passe admin :");
  if (mdp === "technoid") {
    adminZone.style.display = "block";
    chargerCommandes();
    afficherProduitsAdmin();
  } else {
    alert("Mot de passe incorrect !");
  }
});

/* === Enregistrement des commandes === */
document.querySelectorAll(".formulaire").forEach(btn => {
  btn.addEventListener("click", e => {
    const card = e.target.closest(".card");
    const produit = card.dataset.produit;
    const prix = card.dataset.prix;
    const wilaya = card.querySelector(".wilaya").value || "Non prÃ©cisÃ©e";
    const nom = prompt("Nom complet :");
    const numero = prompt("NumÃ©ro de tÃ©lÃ©phone :");

    if (!nom || !numero) {
      alert("Veuillez remplir toutes les informations !");
      return;
    }

    const commande = { produit, prix, wilaya, nom, numero, date: new Date().toLocaleString() };
    enregistrerCommande(commande);
    alert("Commande enregistrÃ©e âœ…");
  });
});

function enregistrerCommande(cmd) {
  let commandes = JSON.parse(localStorage.getItem("commandes") || "[]");
  commandes.push(cmd);
  localStorage.setItem("commandes", JSON.stringify(commandes));
}

/* === Zone commandes === */
function chargerCommandes() {
  const adminPre = document.getElementById("adminPre");
  const commandes = JSON.parse(localStorage.getItem("commandes") || "[]");
  if (commandes.length === 0) {
    adminPre.textContent = "Aucune commande enregistrÃ©e.";
    return;
  }

  adminPre.textContent = "";
  commandes.forEach((c, i) => {
    adminPre.textContent += `${i + 1}. ${c.nom} (${c.numero})\nðŸ“¦ ${c.produit} â€“ ${c.prix} DA\nðŸ“ ${c.wilaya}\nðŸ•’ ${c.date}\n\n`;
  });

  if (!document.getElementById("effacerCommandes")) {
    const effacerBtn = document.createElement("button");
    effacerBtn.id = "effacerCommandes";
    effacerBtn.textContent = "ðŸ—‘ï¸ Effacer toutes les commandes";
    effacerBtn.style.background = "red";
    effacerBtn.style.color = "white";
    effacerBtn.style.border = "none";
    effacerBtn.style.padding = "8px 12px";
    effacerBtn.style.marginTop = "10px";
    effacerBtn.style.cursor = "pointer";
    adminZone.appendChild(effacerBtn);

    effacerBtn.addEventListener("click", () => {
      if (confirm("Supprimer toutes les commandes ?")) {
        localStorage.removeItem("commandes");
        adminPre.textContent = "Aucune commande enregistrÃ©e.";
        alert("Toutes les commandes ont Ã©tÃ© supprimÃ©es !");
      }
    });
  }

  if (!document.getElementById("fermerAdmin")) {
    const fermerBtn = document.createElement("button");
    fermerBtn.id = "fermerAdmin";
    fermerBtn.textContent = "âŒ Fermer la zone admin";
    fermerBtn.style.background = "#555";
    fermerBtn.style.color = "white";
    fermerBtn.style.border = "none";
    fermerBtn.style.padding = "8px 12px";
    fermerBtn.style.marginTop = "10px";
    fermerBtn.style.cursor = "pointer";
    adminZone.appendChild(fermerBtn);

    fermerBtn.addEventListener("click", () => {
      adminZone.style.display = "none";
    });
  }
}

/* === Gestion des photos produits === */
function afficherProduitsAdmin() {
  const existing = document.getElementById("produitsAdmin");
  if (existing) existing.remove();

  const section = document.createElement("div");
  section.id = "produitsAdmin";
  section.innerHTML = "<h3>ðŸ“¸ Modifier les photos des produits</h3>";

  document.querySelectorAll(".card").forEach((card, i) => {
    const produit = card.dataset.produit;
    const img = card.querySelector("img");

    const bloc = document.createElement("div");
    bloc.style.marginBottom = "10px";
    bloc.innerHTML = `
      <p><strong>${produit}</strong></p>
      <input type="file" accept="image/*" id="inputImg${i}" />
    `;

    bloc.querySelector(`#inputImg${i}`).addEventListener("change", event => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          img.src = e.target.result;
          localStorage.setItem(`image_${produit}`, e.target.result);
        };
        reader.readAsDataURL(file);
      }
    });

    section.appendChild(bloc);
  });

  adminZone.appendChild(section);
}

/* === Charger les images enregistrÃ©es === */
window.addEventListener("load", () => {
  document.querySelectorAll(".card").forEach(card => {
    const produit = card.dataset.produit;
    const imgData = localStorage.getItem(`image_${produit}`);
    if (imgData) {
      card.querySelector("img").src = imgData;
    }
  });
});
</script>
</body>
</html>
